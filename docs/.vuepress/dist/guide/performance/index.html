<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>性能优化 | 笔记┉▓</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/doc/bike.png">
    <meta name="description" content="前端笔记 JavaScript css">
    <link rel="preload" href="/doc/assets/css/0.styles.97efef16.css" as="style"><link rel="preload" href="/doc/assets/js/app.bf68736b.js" as="script"><link rel="preload" href="/doc/assets/js/2.7407dee7.js" as="script"><link rel="preload" href="/doc/assets/js/18.bccd39d4.js" as="script"><link rel="prefetch" href="/doc/assets/js/10.0523089d.js"><link rel="prefetch" href="/doc/assets/js/11.5e58f1aa.js"><link rel="prefetch" href="/doc/assets/js/12.98947708.js"><link rel="prefetch" href="/doc/assets/js/13.ed969aad.js"><link rel="prefetch" href="/doc/assets/js/14.5c07b10c.js"><link rel="prefetch" href="/doc/assets/js/15.df9c99fc.js"><link rel="prefetch" href="/doc/assets/js/16.9c645973.js"><link rel="prefetch" href="/doc/assets/js/17.2b5db192.js"><link rel="prefetch" href="/doc/assets/js/19.1f1ed50c.js"><link rel="prefetch" href="/doc/assets/js/20.c762a975.js"><link rel="prefetch" href="/doc/assets/js/21.afe74b56.js"><link rel="prefetch" href="/doc/assets/js/22.3765de37.js"><link rel="prefetch" href="/doc/assets/js/23.cc25a18f.js"><link rel="prefetch" href="/doc/assets/js/24.15a643e7.js"><link rel="prefetch" href="/doc/assets/js/25.2c575eb1.js"><link rel="prefetch" href="/doc/assets/js/26.e679314b.js"><link rel="prefetch" href="/doc/assets/js/27.ffcc6a11.js"><link rel="prefetch" href="/doc/assets/js/28.6cf62828.js"><link rel="prefetch" href="/doc/assets/js/29.eefcd0c3.js"><link rel="prefetch" href="/doc/assets/js/3.6af8052f.js"><link rel="prefetch" href="/doc/assets/js/30.3674e098.js"><link rel="prefetch" href="/doc/assets/js/31.55bf7224.js"><link rel="prefetch" href="/doc/assets/js/32.45ece1a2.js"><link rel="prefetch" href="/doc/assets/js/33.bdf9ebb2.js"><link rel="prefetch" href="/doc/assets/js/34.53eb64df.js"><link rel="prefetch" href="/doc/assets/js/35.5afc430f.js"><link rel="prefetch" href="/doc/assets/js/36.70120f9d.js"><link rel="prefetch" href="/doc/assets/js/37.904e6d1d.js"><link rel="prefetch" href="/doc/assets/js/38.61ea9cae.js"><link rel="prefetch" href="/doc/assets/js/39.abd72f11.js"><link rel="prefetch" href="/doc/assets/js/4.0617df91.js"><link rel="prefetch" href="/doc/assets/js/5.6b84af74.js"><link rel="prefetch" href="/doc/assets/js/6.fe29fe27.js"><link rel="prefetch" href="/doc/assets/js/7.db8d134e.js"><link rel="prefetch" href="/doc/assets/js/8.d6da3e0e.js"><link rel="prefetch" href="/doc/assets/js/9.213c7491.js">
    <link rel="stylesheet" href="/doc/assets/css/0.styles.97efef16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc/" class="home-link router-link-active"><!----> <span class="site-name">笔记┉▓</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc/guide/" class="nav-link router-link-active">
  guide
</a></div><div class="nav-item"><a href="/doc/hjs/" class="nav-link">
  js关联
</a></div><div class="nav-item"><a href="/doc/hcss/" class="nav-link">
  css关联
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc/guide/" class="nav-link router-link-active">
  guide
</a></div><div class="nav-item"><a href="/doc/hjs/" class="nav-link">
  js关联
</a></div><div class="nav-item"><a href="/doc/hcss/" class="nav-link">
  css关联
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>huskar</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/guide/" aria-current="page" class="sidebar-link">哈斯卡</a></li><li><a href="/doc/guide/performance/" aria-current="page" class="active sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/guide/performance/#获取目录上下文" class="sidebar-link">获取目录上下文</a></li><li class="sidebar-sub-header"><a href="/doc/guide/performance/#性能测试" class="sidebar-link">性能测试</a></li></ul></li><li><a href="/doc/guide/node/" class="sidebar-link">node应用</a></li><li><a href="/doc/guide/interview/basic.html" class="sidebar-link">interview</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>动画</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/guide/animation/3d.html" class="sidebar-link">3d动画</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>服务端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/guide/server/nginx.html" class="sidebar-link">nginx</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h1> <h3 id="从前端框架整体浏览器解析的角度进行优化"><a href="#从前端框架整体浏览器解析的角度进行优化" class="header-anchor">#</a> 从前端框架整体浏览器解析的角度进行优化</h3> <ol><li>减少js包的体积大小，减少解析和编译的小号；如：减少无必要的包引入，UI组件按需加载，而不是全局安装。</li> <li>代码切割，对一些必要但很大的包，我们可以进行按需加载；对复杂代码量大的项目可以路由按需加载。</li> <li>通过 <code>script</code> 添加 <code>async</code> 和<code>defer</code> 异步解析；</li> <li>预渲染一个页面，在js解析的过程中，先加载此页面，随后删除、重新渲染页面；提升友好性，减少白屏时间。</li> <li>对解析大、关键性脚本放到head块内。</li> <li>配置 tree shaking 减去无用代码，减少导报体积； <a href="https://www.webpackjs.com/guides/tree-shaking/" target="_blank" rel="noopener noreferrer">tree-shaking<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>WebAssembly 使用c++编写的汇编语言，把js进行编译成浏览器执行执行的代码，大幅度提高运行速度；</li> <li><a href="https://github.com/evanw/esbuild" target="_blank" rel="noopener noreferrer">esbuild<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，一个快速的 JavaScript、TypeScript 代码打包和压缩工具,比其他 JavaScript 打包程序快至少 100 倍(感觉夸大);它是用 Go 语言编写的，该语言可以编译为本地代码。</li></ol> <h3 id="具体业务细节优化"><a href="#具体业务细节优化" class="header-anchor">#</a> 具体业务细节优化</h3> <ol><li>对脚本和图片等静态资源做cdn优化；</li> <li>公共组件、功能抽离；</li> <li>nginx gzip 文件压缩;</li></ol> <h3 id="css-性能优化"><a href="#css-性能优化" class="header-anchor">#</a> css 性能优化</h3> <ol><li>懒加载 css，优先加载关键css;</li> <li>导入通配css文件，减少重复css样式定义；</li> <li>减少@import的使用；</li> <li>js依赖的css放到前面解析；不依赖css，js靠前解析；</li></ol> <h3 id="代码优化技巧"><a href="#代码优化技巧" class="header-anchor">#</a> 代码优化技巧</h3> <ol><li>防抖、节流</li> <li>dom 事件冒泡</li> <li></li></ol> <h2 id="获取目录上下文"><a href="#获取目录上下文" class="header-anchor">#</a> 获取目录上下文</h2> <h3 id="通过webpack中-require-context-api-获取目录上下文"><a href="#通过webpack中-require-context-api-获取目录上下文" class="header-anchor">#</a> 通过webpack中 <code>require.context</code> API 获取目录上下文</h3> <ul><li><p>入参</p> <ol><li>你要引入文件的目录</li> <li>是否要查找该目录下的子级目录</li> <li>匹配要引入的文件</li></ol></li> <li><p>返回的是一个函数，函数有三个属性：resolve 、keys、id</p> <ol><li>resolve: 是一个函数，他返回的是被解析模块的id</li> <li>keys: 也是一个函数，他返回的是一个数组，该数组是由所有可能被上下文模块解析的请求对象组成</li> <li>id：上下文模块的id</li></ol></li></ul> <h3 id="动态获取子路由集合"><a href="#动态获取子路由集合" class="header-anchor">#</a> 动态获取子路由集合:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> exam_childrenRoute <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> requireComponent <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
  <span class="token string">'./pages/collect-exam/module'</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token regex">/\w+\.(vue)$/</span>
<span class="token punctuation">)</span>
requireComponent<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fileName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> componentConfig <span class="token operator">=</span> <span class="token function">requireComponent</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
  <span class="token comment">// `./pages/collect-exam/module/${componentConfig.default.name}`</span>
  exam_childrenRoute<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    path<span class="token operator">:</span> componentConfig<span class="token punctuation">.</span>default<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    name<span class="token operator">:</span> componentConfig<span class="token punctuation">.</span>default<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    component<span class="token operator">:</span> componentConfig<span class="token punctuation">.</span>default <span class="token operator">||</span> componentConfig
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="性能测试"><a href="#性能测试" class="header-anchor">#</a> 性能测试</h2> <h3 id="vue包大小"><a href="#vue包大小" class="header-anchor">#</a> vue包大小</h3> <p>v2单独 vue库打包后 100kb左右，加上vue-router 140kb左右；</p> <p>如果使用了elment-ui等UI框架全局，基础体积将会达到2.5mb左右；</p> <p>v3打包后基础js包80kb，比v2小近20kb;</p> <p>以上是通过vue/cli打包后的大小；如果webpack 配置项去打包vue，64kb。</p> <h3 id="微前端架构"><a href="#微前端架构" class="header-anchor">#</a> 微前端架构</h3> <p>webpack5 出了<code>module feberation</code>，重新定义web前端项目架构，最突出的功能解决了多冗余问题，各打包bundle可以互相共享代码段。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/doc/guide/" class="prev router-link-active">
        哈斯卡
      </a></span> <span class="next"><a href="/doc/guide/node/">
        node应用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc/assets/js/app.bf68736b.js" defer></script><script src="/doc/assets/js/2.7407dee7.js" defer></script><script src="/doc/assets/js/18.bccd39d4.js" defer></script>
  </body>
</html>
